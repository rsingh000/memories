{"ast":null,"code":"import _slicedToArray from\"/Users/mac2018/Desktop/react/projects/memories_project/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useState,useEffect}from'react';import{Link,useHistory,useLocation}from'react-router-dom';import{AppBar,Avatar,Typography,Toolbar,Button}from'@material-ui/core';import useStyles from'./styles';import memoriesLogo from'../../images/memoriesLogo.png';import memoriesText from'../../images/memoriesText.png';import{useDispatch}from'react-redux';import decode from'jwt-decode';import*as actionType from'../../constants/actionTypes';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Navbar=function Navbar(){var classes=useStyles();var _useState=useState(JSON.parse(localStorage.getItem('profile'))),_useState2=_slicedToArray(_useState,2),user=_useState2[0],setUser=_useState2[1];var dispatch=useDispatch();var history=useHistory();var location=useLocation();var logout=function logout(){dispatch({type:actionType.LOGOUT});history.push('/');setUser(null);};useEffect(function(){var token=user===null||user===void 0?void 0:user.token;if(token){var decodedToken=decode(token);if(decodedToken.exp*1000<new Date().getTime())logout();}setUser(JSON.parse(localStorage.getItem('profile')));},[location]);return/*#__PURE__*/_jsxs(AppBar,{className:classes.appBar,position:\"static\",color:\"inherit\",children:[/*#__PURE__*/_jsxs(Link,{to:\"/\",className:classes.brandContainer,children:[/*#__PURE__*/_jsx(\"img\",{component:Link,to:\"/\",src:memoriesText,alt:\"icon\",height:\"45px\"}),/*#__PURE__*/_jsx(\"img\",{className:classes.image,src:memoriesLogo,alt:\"icon\",height:\"40px\"})]}),/*#__PURE__*/_jsx(Toolbar,{className:classes.toolbar,children:user!==null&&user!==void 0&&user.result?/*#__PURE__*/_jsxs(\"div\",{className:classes.profile,children:[/*#__PURE__*/_jsx(Avatar,{className:classes.purple,alt:user.result.name,src:user.result.imgUrl,children:user.result.name.charAt(0)}),/*#__PURE__*/_jsx(Typography,{className:classes.userName,variant:\"h6\",children:user===null||user===void 0?void 0:user.result.name}),/*#__PURE__*/_jsx(Button,{variant:\"contained\",className:classes.logout,color:\"secondary\",onClick:logout,children:\"Logout\"})]}):/*#__PURE__*/_jsx(Button,{component:Link,to:\"/auth\",variant:\"contained\",color:\"primary\",children:\"Sign In\"})})]});};export default Navbar;","map":{"version":3,"names":["React","useState","useEffect","Link","useHistory","useLocation","AppBar","Avatar","Typography","Toolbar","Button","useStyles","memoriesLogo","memoriesText","useDispatch","decode","actionType","Navbar","classes","JSON","parse","localStorage","getItem","user","setUser","dispatch","history","location","logout","type","LOGOUT","push","token","decodedToken","exp","Date","getTime","appBar","brandContainer","image","toolbar","result","profile","purple","name","imgUrl","charAt","userName"],"sources":["/Users/mac2018/Desktop/react/projects/memories_project/client/src/components/Navbar/Navbar.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { Link, useHistory, useLocation } from 'react-router-dom';\nimport { AppBar, Avatar, Typography, Toolbar, Button } from '@material-ui/core';\nimport useStyles from './styles';\nimport memoriesLogo from '../../images/memoriesLogo.png';\nimport memoriesText from '../../images/memoriesText.png';\nimport { useDispatch } from 'react-redux';\nimport decode from 'jwt-decode';\nimport * as actionType from '../../constants/actionTypes';\nconst Navbar = () => {\n\n  const classes = useStyles();\n  const [user, setUser] = useState(JSON.parse(localStorage.getItem('profile')));\n  const dispatch = useDispatch();\n  const history = useHistory();\n  const location = useLocation(); \n\n  const logout = () => {\n    dispatch({ type: actionType.LOGOUT });\n\n    history.push('/');\n\n    setUser(null);\n  }\n\n  useEffect(() => {\n    const token = user?.token;\n\n    if(token) {\n      const decodedToken = decode(token);\n\n      if(decodedToken.exp * 1000 < new Date().getTime()) logout();\n    }\n\n    setUser(JSON.parse(localStorage.getItem('profile')));\n\n  },[location]); \n  \n\n  return (\n    <AppBar className={classes.appBar} position=\"static\" color=\"inherit\">\n        <Link to=\"/\" className={classes.brandContainer}>\n          <img component={Link} to=\"/\" src={memoriesText} alt=\"icon\" height=\"45px\" />\n          <img className={classes.image} src={memoriesLogo} alt=\"icon\" height=\"40px\" />\n        </Link>\n        <Toolbar className={classes.toolbar} >\n            {user?.result ? (\n                <div className={classes.profile}>\n                    <Avatar className={classes.purple} alt={user.result.name} src={user.result.imgUrl}>{user.result.name.charAt(0)}</Avatar>\n                    <Typography className={classes.userName} variant=\"h6\">{user?.result.name}</Typography>\n                    <Button variant=\"contained\" className={classes.logout} color=\"secondary\" onClick={logout}>Logout</Button>\n                </div>\n            ): (\n                <Button component={Link} to=\"/auth\" variant=\"contained\" color=\"primary\">Sign In</Button>\n            )} \n        </Toolbar>\n    </AppBar>\n  )\n}\n\nexport default Navbar"],"mappings":"mJAAA,MAAOA,MAAP,EAAgBC,QAAhB,CAA0BC,SAA1B,KAA2C,OAA3C,CACA,OAASC,IAAT,CAAeC,UAAf,CAA2BC,WAA3B,KAA8C,kBAA9C,CACA,OAASC,MAAT,CAAiBC,MAAjB,CAAyBC,UAAzB,CAAqCC,OAArC,CAA8CC,MAA9C,KAA4D,mBAA5D,CACA,MAAOC,UAAP,KAAsB,UAAtB,CACA,MAAOC,aAAP,KAAyB,+BAAzB,CACA,MAAOC,aAAP,KAAyB,+BAAzB,CACA,OAASC,WAAT,KAA4B,aAA5B,CACA,MAAOC,OAAP,KAAmB,YAAnB,CACA,MAAO,GAAKC,WAAZ,KAA4B,6BAA5B,C,wFACA,GAAMC,OAAM,CAAG,QAATA,OAAS,EAAM,CAEnB,GAAMC,QAAO,CAAGP,SAAS,EAAzB,CACA,cAAwBV,QAAQ,CAACkB,IAAI,CAACC,KAAL,CAAWC,YAAY,CAACC,OAAb,CAAqB,SAArB,CAAX,CAAD,CAAhC,wCAAOC,IAAP,eAAaC,OAAb,eACA,GAAMC,SAAQ,CAAGX,WAAW,EAA5B,CACA,GAAMY,QAAO,CAAGtB,UAAU,EAA1B,CACA,GAAMuB,SAAQ,CAAGtB,WAAW,EAA5B,CAEA,GAAMuB,OAAM,CAAG,QAATA,OAAS,EAAM,CACnBH,QAAQ,CAAC,CAAEI,IAAI,CAAEb,UAAU,CAACc,MAAnB,CAAD,CAAR,CAEAJ,OAAO,CAACK,IAAR,CAAa,GAAb,EAEAP,OAAO,CAAC,IAAD,CAAP,CACD,CAND,CAQAtB,SAAS,CAAC,UAAM,CACd,GAAM8B,MAAK,CAAGT,IAAH,SAAGA,IAAH,iBAAGA,IAAI,CAAES,KAApB,CAEA,GAAGA,KAAH,CAAU,CACR,GAAMC,aAAY,CAAGlB,MAAM,CAACiB,KAAD,CAA3B,CAEA,GAAGC,YAAY,CAACC,GAAb,CAAmB,IAAnB,CAA0B,GAAIC,KAAJ,GAAWC,OAAX,EAA7B,CAAmDR,MAAM,GAC1D,CAEDJ,OAAO,CAACL,IAAI,CAACC,KAAL,CAAWC,YAAY,CAACC,OAAb,CAAqB,SAArB,CAAX,CAAD,CAAP,CAED,CAXQ,CAWP,CAACK,QAAD,CAXO,CAAT,CAcA,mBACE,MAAC,MAAD,EAAQ,SAAS,CAAET,OAAO,CAACmB,MAA3B,CAAmC,QAAQ,CAAC,QAA5C,CAAqD,KAAK,CAAC,SAA3D,wBACI,MAAC,IAAD,EAAM,EAAE,CAAC,GAAT,CAAa,SAAS,CAAEnB,OAAO,CAACoB,cAAhC,wBACE,YAAK,SAAS,CAAEnC,IAAhB,CAAsB,EAAE,CAAC,GAAzB,CAA6B,GAAG,CAAEU,YAAlC,CAAgD,GAAG,CAAC,MAApD,CAA2D,MAAM,CAAC,MAAlE,EADF,cAEE,YAAK,SAAS,CAAEK,OAAO,CAACqB,KAAxB,CAA+B,GAAG,CAAE3B,YAApC,CAAkD,GAAG,CAAC,MAAtD,CAA6D,MAAM,CAAC,MAApE,EAFF,GADJ,cAKI,KAAC,OAAD,EAAS,SAAS,CAAEM,OAAO,CAACsB,OAA5B,UACKjB,IAAI,OAAJ,EAAAA,IAAI,SAAJ,EAAAA,IAAI,CAAEkB,MAAN,cACG,aAAK,SAAS,CAAEvB,OAAO,CAACwB,OAAxB,wBACI,KAAC,MAAD,EAAQ,SAAS,CAAExB,OAAO,CAACyB,MAA3B,CAAmC,GAAG,CAAEpB,IAAI,CAACkB,MAAL,CAAYG,IAApD,CAA0D,GAAG,CAAErB,IAAI,CAACkB,MAAL,CAAYI,MAA3E,UAAoFtB,IAAI,CAACkB,MAAL,CAAYG,IAAZ,CAAiBE,MAAjB,CAAwB,CAAxB,CAApF,EADJ,cAEI,KAAC,UAAD,EAAY,SAAS,CAAE5B,OAAO,CAAC6B,QAA/B,CAAyC,OAAO,CAAC,IAAjD,UAAuDxB,IAAvD,SAAuDA,IAAvD,iBAAuDA,IAAI,CAAEkB,MAAN,CAAaG,IAApE,EAFJ,cAGI,KAAC,MAAD,EAAQ,OAAO,CAAC,WAAhB,CAA4B,SAAS,CAAE1B,OAAO,CAACU,MAA/C,CAAuD,KAAK,CAAC,WAA7D,CAAyE,OAAO,CAAEA,MAAlF,oBAHJ,GADH,cAOG,KAAC,MAAD,EAAQ,SAAS,CAAEzB,IAAnB,CAAyB,EAAE,CAAC,OAA5B,CAAoC,OAAO,CAAC,WAA5C,CAAwD,KAAK,CAAC,SAA9D,qBARR,EALJ,GADF,CAmBD,CAjDD,CAmDA,cAAec,OAAf"},"metadata":{},"sourceType":"module"}