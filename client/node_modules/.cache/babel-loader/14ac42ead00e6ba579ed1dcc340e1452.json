{"ast":null,"code":"import _regeneratorRuntime from\"/Users/mac2018/Desktop/react/projects/memories_project/client/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _toConsumableArray from\"/Users/mac2018/Desktop/react/projects/memories_project/client/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _asyncToGenerator from\"/Users/mac2018/Desktop/react/projects/memories_project/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/mac2018/Desktop/react/projects/memories_project/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useState}from'react';import useStyles from'./styles';import{Card,CardActions,CardContent,CardMedia,Button,Typography,ButtonBase}from'@material-ui/core';import ThumbUpAltIcon from'@material-ui/icons/ThumbUpAlt';import DeleteIcon from'@material-ui/icons/Delete';import MoreHorizIcon from'@material-ui/icons/MoreHoriz';import moment from'moment';import{useDispatch}from'react-redux';import{deletePost,likePost}from'../../../actions/posts';import ThumbUpAltOutlined from'@material-ui/icons/ThumbUpAltOutlined';import{useHistory}from'react-router-dom';import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Post=function Post(_ref){var _user$result9,_user$result10,_user$result11,_user$result12;var post=_ref.post,setCurrentId=_ref.setCurrentId;var classes=useStyles();var dispatch=useDispatch();var user=JSON.parse(localStorage.getItem('profile'));var history=useHistory();var hasLikedPost=post.likes.find(function(like){var _user$result,_user$result2;return like===((user===null||user===void 0?void 0:(_user$result=user.result)===null||_user$result===void 0?void 0:_user$result.sub)||(user===null||user===void 0?void 0:(_user$result2=user.result)===null||_user$result2===void 0?void 0:_user$result2._id));});var _useState=useState(post===null||post===void 0?void 0:post.likes),_useState2=_slicedToArray(_useState,2),likes=_useState2[0],setLikes=_useState2[1];var Likes=function Likes(){var _post$likes;if((post===null||post===void 0?void 0:(_post$likes=post.likes)===null||_post$likes===void 0?void 0:_post$likes.length)>0){return likes.find(function(like){var _user$result3,_user$result4;return like===((user===null||user===void 0?void 0:(_user$result3=user.result)===null||_user$result3===void 0?void 0:_user$result3.sub)||(user===null||user===void 0?void 0:(_user$result4=user.result)===null||_user$result4===void 0?void 0:_user$result4._id));})?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(ThumbUpAltIcon,{fontSize:\"small\"}),\"\\xA0\",likes.length>2?\"You and \".concat(likes.length-1,\" others\"):\"\".concat(likes.length,\" like\").concat(likes.length>1?'s':'')]}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(ThumbUpAltOutlined,{fontSize:\"small\"}),\"\\xA0\",likes.length,\" \",likes.length===1?'Like':'Likes']});}return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(ThumbUpAltOutlined,{fontSize:\"small\"}),\"\\xA0Like\"]});};var openPost=function openPost(){history.push(\"/posts/\".concat(post._id));};var handleLike=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var _user$result7,_user$result8;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:dispatch(likePost(post._id));if(hasLikedPost){setLikes(likes.filter(function(id){var _user$result5,_user$result6;return id!==((user===null||user===void 0?void 0:(_user$result5=user.result)===null||_user$result5===void 0?void 0:_user$result5.sub)||(user===null||user===void 0?void 0:(_user$result6=user.result)===null||_user$result6===void 0?void 0:_user$result6._id));}));}else{setLikes([].concat(_toConsumableArray(likes),[(user===null||user===void 0?void 0:(_user$result7=user.result)===null||_user$result7===void 0?void 0:_user$result7.sub)||(user===null||user===void 0?void 0:(_user$result8=user.result)===null||_user$result8===void 0?void 0:_user$result8._id)]));}case 2:case\"end\":return _context.stop();}}},_callee);}));return function handleLike(){return _ref2.apply(this,arguments);};}();return/*#__PURE__*/_jsxs(Card,{className:classes.card,raised:true,elevation:6,children:[/*#__PURE__*/_jsxs(ButtonBase,{className:classes.cardAction,onClick:openPost,children:[/*#__PURE__*/_jsx(CardMedia,{className:classes.media,image:post.selectedFile,title:post.title}),/*#__PURE__*/_jsxs(\"div\",{className:classes.overlay,children:[/*#__PURE__*/_jsx(Typography,{variant:\"h6\",children:post.name}),/*#__PURE__*/_jsx(Typography,{variant:\"body2\",children:moment(post.createdAt).fromNow()})]}),((user===null||user===void 0?void 0:(_user$result9=user.result)===null||_user$result9===void 0?void 0:_user$result9.sub)===(post===null||post===void 0?void 0:post.creator)||(user===null||user===void 0?void 0:(_user$result10=user.result)===null||_user$result10===void 0?void 0:_user$result10._id)===(post===null||post===void 0?void 0:post.creator))&&/*#__PURE__*/_jsx(\"div\",{className:classes.overlay2,children:/*#__PURE__*/_jsx(Button,{style:{color:'white'},size:\"small\",onClick:function onClick(){return setCurrentId(post._id);},children:/*#__PURE__*/_jsx(MoreHorizIcon,{fontSize:\"medium\"})})}),/*#__PURE__*/_jsx(\"div\",{className:classes.details,children:/*#__PURE__*/_jsx(Typography,{variant:\"body2\",color:\"textSecondary\",children:post.tags.map(function(tag){return\"#\".concat(tag,\" \");})})}),/*#__PURE__*/_jsx(Typography,{className:classes.title,gutterBottom:true,variant:\"h5\",component:\"h2\",children:post.title}),/*#__PURE__*/_jsx(CardContent,{children:/*#__PURE__*/_jsx(Typography,{variant:\"body2\",color:\"textSecondary\",component:\"p\",children:post.message})})]}),/*#__PURE__*/_jsxs(CardActions,{className:classes.cardActions,children:[/*#__PURE__*/_jsx(Button,{size:\"small\",color:\"primary\",disabled:!(user!==null&&user!==void 0&&user.result),onClick:handleLike,children:/*#__PURE__*/_jsx(Likes,{})}),((user===null||user===void 0?void 0:(_user$result11=user.result)===null||_user$result11===void 0?void 0:_user$result11.sub)===(post===null||post===void 0?void 0:post.creator)||(user===null||user===void 0?void 0:(_user$result12=user.result)===null||_user$result12===void 0?void 0:_user$result12._id)===(post===null||post===void 0?void 0:post.creator))&&/*#__PURE__*/_jsxs(Button,{size:\"small\",color:\"primary\",onClick:function onClick(){return dispatch(deletePost(post._id));},children:[/*#__PURE__*/_jsx(DeleteIcon,{className:classes.delete,fontSize:\"small\"}),/*#__PURE__*/_jsx(\"span\",{style:{color:'#f50057'},children:\"Delete\"})]})]})]});};export default Post;","map":{"version":3,"names":["React","useState","useStyles","Card","CardActions","CardContent","CardMedia","Button","Typography","ButtonBase","ThumbUpAltIcon","DeleteIcon","MoreHorizIcon","moment","useDispatch","deletePost","likePost","ThumbUpAltOutlined","useHistory","Post","post","setCurrentId","classes","dispatch","user","JSON","parse","localStorage","getItem","history","hasLikedPost","likes","find","like","result","sub","_id","setLikes","Likes","length","openPost","push","handleLike","filter","id","card","cardAction","media","selectedFile","title","overlay","name","createdAt","fromNow","creator","overlay2","color","details","tags","map","tag","message","cardActions","delete"],"sources":["/Users/mac2018/Desktop/react/projects/memories_project/client/src/components/Posts/Post/Post.js"],"sourcesContent":["import React, { useState } from 'react'\nimport useStyles from './styles';\nimport { Card, CardActions, CardContent, CardMedia, Button, Typography, ButtonBase} from '@material-ui/core';\nimport ThumbUpAltIcon from '@material-ui/icons/ThumbUpAlt';\nimport DeleteIcon from '@material-ui/icons/Delete';\nimport MoreHorizIcon from '@material-ui/icons/MoreHoriz';\nimport moment from 'moment';\nimport { useDispatch } from 'react-redux';\nimport { deletePost, likePost } from '../../../actions/posts';\nimport ThumbUpAltOutlined from '@material-ui/icons/ThumbUpAltOutlined';\nimport { useHistory } from 'react-router-dom';\n\nconst Post = ({ post, setCurrentId }) => {\n    \n  const classes = useStyles();\n  const dispatch = useDispatch();\n  const user = JSON.parse(localStorage.getItem('profile'));\n  const history = useHistory();\n  const hasLikedPost = post.likes.find((like) => like === (user?.result?.sub || user?.result?._id))\n  const [likes, setLikes] = useState(post?.likes);\n\n  const Likes = () => {\n    if (post?.likes?.length > 0 ) {\n      return likes.find((like) => like === (user?.result?.sub || user?.result?._id))\n        ? (\n          <><ThumbUpAltIcon fontSize=\"small\"/>&nbsp;{likes.length > 2 ? `You and ${likes.length - 1} others` : `${likes.length} like${likes.length > 1 ?  's' : ''}`}</>\n        ) : (\n          <><ThumbUpAltOutlined fontSize=\"small\" />&nbsp;{likes.length} {likes.length === 1 ? 'Like' : 'Likes'}</>\n        );\n    }\n\n    return <><ThumbUpAltOutlined fontSize=\"small\" />&nbsp;Like</>;\n  };\n\n\n  const openPost = () => {\n    history.push(`/posts/${post._id}`);\n  }\n\n  const handleLike = async () => {\n    dispatch(likePost(post._id));\n    if(hasLikedPost) {\n      setLikes(likes.filter((id) => id !== (user?.result?.sub || user?.result?._id)))\n    } else {\n      setLikes([ ...likes, (user?.result?.sub || user?.result?._id)])\n    }\n  }\n\n  return (\n    <Card className={classes.card} raised elevation={6}>\n      <ButtonBase className={classes.cardAction} onClick={openPost}>\n        <CardMedia className={classes.media} image={post.selectedFile} title={post.title}/>\n        <div className={classes.overlay}>\n          <Typography variant=\"h6\">{post.name}</Typography>\n          <Typography variant=\"body2\">{moment(post.createdAt).fromNow()}</Typography>\n        </div>\n        {(user?.result?.sub === post?.creator || user?.result?._id === post?.creator) && (\n          <div className={classes.overlay2}>\n            <Button style={{color: 'white'}} size=\"small\" onClick={() => setCurrentId(post._id)}>\n              <MoreHorizIcon fontSize=\"medium\" />\n            </Button>\n          </div>\n        )}\n        <div className={classes.details}>\n          <Typography variant=\"body2\" color=\"textSecondary\">{post.tags.map((tag) => `#${tag} `)}</Typography>\n        </div>\n        <Typography className={classes.title} gutterBottom variant=\"h5\" component=\"h2\">{post.title}</Typography>\n        <CardContent>\n          <Typography variant=\"body2\" color=\"textSecondary\" component=\"p\">{post.message}</Typography>\n        </CardContent>\n      </ButtonBase>\n      <CardActions className={classes.cardActions}>\n        <Button size=\"small\" color=\"primary\" disabled={!user?.result} onClick={handleLike} >\n          <Likes />\n        </Button>\n        {(user?.result?.sub === post?.creator || user?.result?._id === post?.creator) && (\n          <Button size=\"small\" color=\"primary\" onClick={() => dispatch(deletePost(post._id))} >\n            <DeleteIcon className={classes.delete} fontSize=\"small\" />\n            <span style={{ color: '#f50057'}}>Delete</span>\n          </Button>\n        )}\n      </CardActions>\n    </Card>\n  )\n}\n\nexport default Post"],"mappings":"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"},"metadata":{},"sourceType":"module"}